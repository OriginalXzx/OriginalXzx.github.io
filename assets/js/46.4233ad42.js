(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{465:function(t,a,s){"use strict";s.r(a);var r=s(1),c=Object(r.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",[t._v("cpu 00%占用在java程序开发中属于常见的异常情况，本文章通过记录一次cpu占用100%的排查过程，给读者一些cpu负载过高的排坑经验。")])]),t._v(" "),s("h2",{attrs:{id:"一、背景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、背景"}},[t._v("#")]),t._v(" 一、背景")]),t._v(" "),s("p",[t._v("线上机器频繁报警cpu使用率过高，第二天决定排查一下这个问题")]),t._v(" "),s("h2",{attrs:{id:"二、排查过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、排查过程"}},[t._v("#")]),t._v(" 二、排查过程")]),t._v(" "),s("h3",{attrs:{id:"申请线上机器sudo权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#申请线上机器sudo权限"}},[t._v("#")]),t._v(" 申请线上机器sudo权限")]),t._v(" "),s("p",[t._v("公司里面线上机器一般员工是没有sudo权限的，所以第一步需要申请权限")]),t._v(" "),s("h3",{attrs:{id:"找到线上机器java进程id-linux直接使用-top-指令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#找到线上机器java进程id-linux直接使用-top-指令"}},[t._v("#")]),t._v(" 找到线上机器java进程Id linux直接使用 "),s("strong",[t._v("top")]),t._v(" 指令")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://p0.meituan.net/scarlett/b65161f7f4c465055da2b717a5acf55a249667.jpg",alt:"avatar"}})]),t._v(" "),s("h3",{attrs:{id:"top-hp-pid"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#top-hp-pid"}},[t._v("#")]),t._v(" top -Hp [pid]")]),t._v(" "),s("p",[t._v("找到占用cpu最多的线程"),s("br"),t._v(" "),s("img",{attrs:{src:"http://p0.meituan.net/scarlett/04b8592a45a6fc7b87cb82385718ef1e376027.jpg",alt:"avatar"}})]),t._v(" "),s("h3",{attrs:{id:"jstack-l-pid-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jstack-l-pid-file"}},[t._v("#")]),t._v(" jstack -l [pid] > file")]),t._v(" "),s("p",[t._v("通过jstack指令把jvm堆栈信息打印到文件里面，比如本次案列用的指令是 "),s("code",[t._v("jstack -l 128187 > a.text")])]),t._v(" "),s("h3",{attrs:{id:"通过堆栈日志，找到cpu占用最高的线程信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通过堆栈日志，找到cpu占用最高的线程信息"}},[t._v("#")]),t._v(" 通过堆栈日志，找到cpu占用最高的线程信息")]),t._v(" "),s("p",[t._v("这里需要先把线程id转换为16进制数\n"),s("img",{attrs:{src:"http://p1.meituan.net/scarlett/059425c88ac646135346fcae1c8b819b68568.jpg",alt:"avatar"}})]),t._v(" "),s("p",[t._v("再去堆栈日志里面搜索线程相关数据\n"),s("img",{attrs:{src:"http://p0.meituan.net/scarlett/cd38d5933a97ecb09cf418ed2b0d031b253998.jpg",alt:"avatar"}})]),t._v(" "),s("p",[t._v("这里一般就可以定位到具体问题代码位置，然后再去分析问题代码执行过程，一般就可以解密，本次案例是因为死循环执行导致cpu占用率过高导致的。"),s("br")]),t._v(" "),s("p",[t._v("如果说还要具体分析jvm内存信息，可以参考我另一篇博文："),s("a",{attrs:{href:"http://www.originalxzx.top/categories/fullgc.html#%E4%B8%80%E3%80%81%E8%83%8C%E6%99%AF"}},[t._v("记一次线上机器 full gc 排查过程")])])])}),[],!1,null,null,null);a.default=c.exports}}]);